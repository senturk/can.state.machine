!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports["Can State Machine"]=s():t["Can State Machine"]=s()}(this,(function(){return function(){"use strict";var t={114:function(t){class s{static ASYNCHRONOUS="asynchrounous call waiting for next step";constructor(t={}){this.data={},this.states={},this.transitions=[],this.metrics={loop_counter:0,states:0,transitions:0,log:[],execution:{start:new Date,end:0,duration:0}},this.config_loop_max=t.loopMax||-1,this.loop_max=this.config_loop_max>0?this.config_loop_max:1}get_duration(){return new Date-this.metrics.execution.start}addStatus(t,s){var e=t.toLowerCase();if(this.states[e])throw new Error("WebStateMachine status already existing. Overwrite is not alled! Status-name: '"+t+"' -> important the status name is not case sensitive!!");this.states[e]=s}addTransition(t,s,e){var i=t.toLowerCase(),n=s.toLowerCase();if(this._find_transition(i,n))throw new Error("Transition from one state to the other state is already set: '"+t+"' -> '"+s+"' | important: the status names are case insensitive!");this.transitions.push({status_from:i,status_to:n,transition_function:e})}check(){return!!this.states.start&&!!this.states.end&&!(!this.states.start||!this.states.end)}start(){if(!this.check())throw new Error("The WebStateMachine is not configured well!");this.previous_status=void 0,this.current_status=void 0,this.finished=!1,this.metrics.execution.start=new Date,this.asyncProceed("start")}asyncProceed(t){this.next_status=t,this.next_status&&(this.next_status=this.next_status.toLowerCase());for(var e=!1;!this.finished&&this.next_status&&this.metrics.loop_counter<this.loop_max&&!e;){this.metrics.loop_counter++,this.config_loop_max<=0&&(this.loop_max=this.metrics.loop_counter+1);var i=this._find_transition(this.current_status,this.next_status);if(i&&(this.metrics.log.push("'"+this.current_status+"' -> '"+this.next_status+"'"),console.log("transition: %s -> %s, loop_count: %i",this.current_status,this.next_status,this.metrics.loop_counter),i.transition_function(),i=void 0),this.previous_status=this.current_status,this.current_status=this.next_status,this.metrics.log.push(this.current_status),this.next_status=this.states[this.current_status](this.previous_status),this.next_status===s.ASYNCHRONOUS)e=!0;else{if(this.next_status&&(this.next_status=this.next_status.toLowerCase()),void 0===this.next_status&&"end"===this.current_status);else if(!this.states[this.next_status])throw new Error("Status not existing: '"+this.next_status+"' returned from status: '"+this.current_status+"'");"end"===this.current_status&&(this.finished=!0,this.metrics.execution.end=new Date,this.metrics.execution.duration=this.metrics.execution.end-this.metrics.execution.start)}}if(this.metrics.loop_counter>=this.loop_max)throw new Error("CanStateMachine Loop Max Counter reached: '"+this.loop_max+"' change configuration, or find issue.")}_find_transition(t,s){return this.transitions.find((e=>e.status_from===t&&e.status_to===s))}}t.exports?t.exports=s:"undefined"!=typeof window&&(window.csm=s)}},s={};return function e(i){var n=s[i];if(void 0!==n)return n.exports;var o=s[i]={exports:{}};return t[i](o,o.exports,e),o.exports}(114)}()}));